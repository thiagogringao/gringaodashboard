â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ðŸš€ COMANDOS PARA EXECUTAR NO SERVIDOR - COPIE E COLE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

PASSO 1: CONECTAR NO SERVIDOR
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ssh root@72.61.40.170
Senha: Admingringao1211.


PASSO 2: CRIAR E EXECUTAR SCRIPT DE DEPLOY
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Copie e cole TODO o bloco abaixo de uma vez:

cat > /root/deploy.sh << 'EOFSCRIPT'
#!/bin/bash
set -e

echo "ðŸš€ INICIANDO DEPLOY"
echo "==================="

# Atualizar sistema
echo "ðŸ“¦ Atualizando sistema..."
apt update -qq && apt upgrade -y -qq

# Instalar Node.js
echo "ðŸ“¦ Instalando Node.js..."
if ! command -v node &> /dev/null; then
    curl -fsSL https://deb.nodesource.com/setup_18.x | bash -
    apt install -y nodejs
fi
echo "âœ… Node.js: $(node --version)"

# Instalar PM2
echo "ðŸ“¦ Instalando PM2..."
if ! command -v pm2 &> /dev/null; then
    npm install -g pm2
fi
echo "âœ… PM2: v$(pm2 --version)"

# Instalar Nginx
echo "ðŸ“¦ Instalando Nginx..."
if ! command -v nginx &> /dev/null; then
    apt install -y nginx
fi
echo "âœ… Nginx instalado"

# Criar diretÃ³rios
echo "ðŸ“ Criando diretÃ³rios..."
mkdir -p /var/www/dashboard/backend/cache
mkdir -p /var/www/dashboard/frontend
mkdir -p /var/www/dashboard/logs
mkdir -p /var/backups/dashboard
echo "âœ… DiretÃ³rios criados"

# Verificar arquivos
echo "ðŸ” Verificando arquivos..."
if [ ! -f "/var/www/dashboard/backend/server.js" ]; then
    echo "âŒ Backend nÃ£o encontrado em /var/www/dashboard/backend/"
    echo "âš ï¸  Transfira os arquivos primeiro!"
    exit 1
fi
if [ ! -f "/var/www/dashboard/backend/.env" ]; then
    echo "âŒ .env nÃ£o encontrado em /var/www/dashboard/backend/"
    echo "âš ï¸  Transfira o arquivo .env.production como .env"
    exit 1
fi
if [ ! -f "/var/www/dashboard/frontend/index.html" ]; then
    echo "âŒ Frontend nÃ£o encontrado em /var/www/dashboard/frontend/"
    echo "âš ï¸  Transfira os arquivos do frontend/dist/"
    exit 1
fi
echo "âœ… Arquivos verificados"

# Instalar dependÃªncias
echo "ðŸ“¦ Instalando dependÃªncias..."
cd /var/www/dashboard/backend
npm install --production --silent
echo "âœ… DependÃªncias instaladas"

# Ajustar permissÃµes
echo "ðŸ”’ Ajustando permissÃµes..."
chmod 600 /var/www/dashboard/backend/.env
chmod 755 /var/www/dashboard/backend/server.js
chmod -R 755 /var/www/dashboard/frontend
echo "âœ… PermissÃµes ajustadas"

# Configurar PM2
echo "âš™ï¸  Configurando PM2..."
cat > /var/www/dashboard/backend/ecosystem.config.js << 'EOFPM2'
module.exports = {
  apps: [{
    name: 'dashboard-backend',
    script: './server.js',
    instances: 2,
    exec_mode: 'cluster',
    env: {
      NODE_ENV: 'production',
      PORT: 3001
    },
    error_file: '../logs/backend-error.log',
    out_file: '../logs/backend-out.log',
    log_date_format: 'YYYY-MM-DD HH:mm:ss',
    merge_logs: true,
    autorestart: true,
    max_memory_restart: '1G',
    watch: false
  }]
};
EOFPM2
echo "âœ… PM2 configurado"

# Parar aplicaÃ§Ãµes anteriores
echo "â¸ï¸  Parando aplicaÃ§Ãµes anteriores..."
pm2 delete all 2>/dev/null || true

# Iniciar aplicaÃ§Ã£o
echo "â–¶ï¸  Iniciando aplicaÃ§Ã£o..."
cd /var/www/dashboard/backend
pm2 start ecosystem.config.js
pm2 save
pm2 startup systemd -u root --hp /root 2>/dev/null || true
echo "âœ… AplicaÃ§Ã£o iniciada"

# Configurar Nginx
echo "ðŸŒ Configurando Nginx..."
cat > /etc/nginx/sites-available/dashboard << 'EOFNGINX'
server {
    listen 80;
    server_name 72.61.40.170;

    access_log /var/log/nginx/dashboard-access.log;
    error_log /var/log/nginx/dashboard-error.log;

    location / {
        root /var/www/dashboard/frontend;
        try_files $uri $uri/ /index.html;
        
        location ~* \.(js|css|png|jpg|jpeg|gif|ico|svg|woff|woff2|ttf|eot)$ {
            expires 1y;
            add_header Cache-Control "public, immutable";
        }
    }

    location /api/ {
        proxy_pass http://localhost:3001/api/;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_cache_bypass $http_upgrade;
        proxy_connect_timeout 60s;
        proxy_send_timeout 60s;
        proxy_read_timeout 60s;
    }

    gzip on;
    gzip_vary on;
    gzip_min_length 1024;
    gzip_types text/plain text/css text/xml text/javascript application/x-javascript application/xml+rss application/json application/javascript;
}
EOFNGINX

ln -sf /etc/nginx/sites-available/dashboard /etc/nginx/sites-enabled/
rm -f /etc/nginx/sites-enabled/default
nginx -t
systemctl restart nginx
systemctl enable nginx
echo "âœ… Nginx configurado"

# Configurar firewall
echo "ðŸ”’ Configurando firewall..."
apt install -y ufw -qq
ufw allow 22/tcp
ufw allow 80/tcp
ufw allow 443/tcp
ufw --force enable
echo "âœ… Firewall configurado"

# Aguardar inicializaÃ§Ã£o
echo "â³ Aguardando inicializaÃ§Ã£o..."
sleep 5

# VerificaÃ§Ã£o final
echo ""
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "âœ… DEPLOY CONCLUÃDO!"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo ""
echo "ðŸ“Š Status do PM2:"
pm2 status
echo ""
echo "ðŸ”¥ Testando backend:"
curl -s http://localhost:3001/health || echo "Inicializando..."
echo ""
echo ""
echo "ðŸŒ Acesse: http://72.61.40.170"
echo ""
echo "ðŸ“Š Comandos Ãºteis:"
echo "  â€¢ Ver logs:    pm2 logs dashboard-backend"
echo "  â€¢ Ver status:  pm2 status"
echo "  â€¢ Reiniciar:   pm2 restart dashboard-backend"
echo ""
EOFSCRIPT

chmod +x /root/deploy.sh
bash /root/deploy.sh


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ðŸ“ IMPORTANTE: ANTES DE EXECUTAR O SCRIPT ACIMA
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

VocÃª PRECISA transferir os arquivos primeiro! Use WinSCP ou SCP:

1. Backend completo â†’ /var/www/dashboard/backend/
2. .env.production (renomear para .env) â†’ /var/www/dashboard/backend/.env
3. Frontend (pasta dist) â†’ /var/www/dashboard/frontend/


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ðŸ”§ COMANDOS PARA TRANSFERIR ARQUIVOS (PowerShell)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# Criar diretÃ³rios primeiro
ssh root@72.61.40.170 "mkdir -p /var/www/dashboard/backend /var/www/dashboard/frontend"

# Transferir backend
scp -r .\backend\* root@72.61.40.170:/var/www/dashboard/backend/

# Transferir .env
scp .\backend\.env.production root@72.61.40.170:/var/www/dashboard/backend/.env

# Transferir frontend
scp -r .\frontend\dist\* root@72.61.40.170:/var/www/dashboard/frontend/


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
âœ… DEPOIS DE TRANSFERIR, EXECUTE O SCRIPT DE DEPLOY
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ssh root@72.61.40.170
(Cole o bloco do PASSO 2 acima)


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ðŸ“Š VERIFICAR STATUS APÃ“S DEPLOY
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

pm2 status
pm2 logs dashboard-backend
curl http://localhost:3001/health


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ðŸŒ ACESSAR APLICAÃ‡ÃƒO
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

http://72.61.40.170


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
